<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>File: executable</title>
<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: executable</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'>
<p>require ‘sprout/executable/param’ require
‘sprout/executable/collection_param’ require ‘sprout/executable/boolean’
require ‘sprout/executable/number’ require ‘sprout/executable/string_param’
require ‘sprout/executable/strings’ require ‘sprout/executable/file_param’
require ‘sprout/executable/files’ require ‘sprout/executable/path’ require
‘sprout/executable/paths’ require ‘sprout/executable/url’ require
‘sprout/executable/urls’ require ‘sprout/executable/parameter_factory’
require ‘rake/clean’</p>

<p>module Sprout</p>

<pre class="code"><span class='comment'>##
</span><span class='comment'># The Sprout::Executable module exposes a Domain Specific Language
</span><span class='comment'># for describing Command Line Interface (CLI) applications.
</span><span class='comment'>#
</span><span class='comment'># This module can be included by any class, and depending on how that class
</span><span class='comment'># is used, one can either parse command line arguments into meaningful, 
</span><span class='comment'># structured data, or delegate ruby code and configuration to an existing,
</span><span class='comment'># external command line process.
</span><span class='comment'>#
</span><span class='comment'># Following is an example of how one could define an executable Ruby
</span><span class='comment'># application using this module:
</span><span class='comment'>#
</span><span class='comment'># :include: ../../test/fixtures/examples/echo_inputs.rb
</span><span class='comment'>#
</span><span class='kw'>module</span> <span class='const'>Executable</span>
  <span class='id include'>include</span> <span class='const'>RubyFeature</span>

  <span class='const'>DEFAULT_FILE_EXPRESSION</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/**/**/*</span><span class='tstring_end'>'</span></span>
  <span class='const'>DEFAULT_PREFIX</span>          <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>--</span><span class='tstring_end'>'</span></span>
  <span class='const'>DEFAULT_SHORT_PREFIX</span>    <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>-</span><span class='tstring_end'>'</span></span>

  <span class='id extend'>extend</span> <span class='const'>Concern</span>

  <span class='kw'>module</span> <span class='const'>ClassMethods</span>
    <span class='comment'>##
</span>    <span class='comment'># +add_param+ is the workhorse of the Task.
</span>    <span class='comment'># This method is used to add new shell parameters to the executable interface.
</span>    <span class='comment'>#
</span>    <span class='comment'># +name+ is a symbol or string that represents the parameter that you would like to add
</span>    <span class='comment'># such as :debug or :source_path.
</span>    <span class='comment'>#
</span>    <span class='comment'># +type+ is a class reference of the Executable::Param that you'd like to use. 
</span>    <span class='comment'># At the time of this writing, add_param will accept 2 class references that 
</span>    <span class='comment'># do not extend Param - String and File. The ParameterFactory will automatically
</span>    <span class='comment'># resolve these to the correct data type when they are created.
</span>    <span class='comment'>#
</span>    <span class='comment'>#   Boolean  true or false
</span>    <span class='comment'>#   File     Path to a file
</span>    <span class='comment'>#   Number   Any number
</span>    <span class='comment'>#   Path     Path to a directory
</span>    <span class='comment'>#   String   Any string value
</span>    <span class='comment'>#   Url      Basic URL
</span>    <span class='comment'>#
</span>    <span class='comment'>#   Files    Collection of files
</span>    <span class='comment'>#   Paths    Collection of directories
</span>    <span class='comment'>#   Strings  Collection of arbitrary strings
</span>    <span class='comment'>#   Urls     Collection of URLs
</span>    <span class='comment'>#
</span>    <span class='comment'># Be sure to check out the Sprout::Executable::Param class to learn more about
</span>    <span class='comment'># working with executable parameters.
</span>    <span class='comment'>#
</span>    <span class='comment'># Once parameters have been added using the +add_param+ method, clients
</span>    <span class='comment'># can set and get those parameters from any newly created executable instance,
</span>    <span class='comment'># or from the command line.
</span>    <span class='comment'>#
</span>    <span class='comment'># In the case of an executable delegate, parameter values will be sent to the 
</span>    <span class='comment'># command line executable in the order they are added using +add_param+.
</span>    <span class='comment'>#
</span>    <span class='comment'># In the case of a Ruby executable, command line parameters will be interpreted
</span>    <span class='comment'># in the order they are defined using +add_param+.
</span>    <span class='comment'>#
</span>    <span class='kw'>def</span> <span class='id add_param'>add_param</span><span class='lparen'>(</span><span class='id name'>name</span><span class='comma'>,</span> <span class='id type'>type</span><span class='comma'>,</span> <span class='id options'>options</span><span class='op'>=</span><span class='kw'>nil</span><span class='rparen'>)</span> <span class='comment'># :yields: Sprout::Executable::Param
</span>      <span class='id raise'>raise</span> <span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Errors</span><span class='op'>::</span><span class='const'>UsageError</span><span class='period'>.</span><span class='id new'>new</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[DEPRECATED] add_param no longer uses closures, you can provide the same values as a hash in the optional last argument.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
      <span class='id raise'>raise</span> <span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Errors</span><span class='op'>::</span><span class='const'>UsageError</span><span class='period'>.</span><span class='id new'>new</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The first parameter (name:SymbolOrString) is required</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id name'>name</span><span class='period'>.</span><span class='id nil?'>nil?</span>
      <span class='id raise'>raise</span> <span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Errors</span><span class='op'>::</span><span class='const'>UsageError</span><span class='period'>.</span><span class='id new'>new</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The second parameter (type:Class) is required</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id type'>type</span><span class='period'>.</span><span class='id nil?'>nil?</span>
      <span class='id raise'>raise</span> <span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Errors</span><span class='op'>::</span><span class='const'>UsageError</span><span class='period'>.</span><span class='id new'>new</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The type parameter must be a Class by reference</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='op'>!</span><span class='id type'>type</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Class</span><span class='rparen'>)</span>

      <span class='id options'>options</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
      <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id name'>name</span>
      <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id type'>type</span>
      <span class='comment'># TODO: Integrate the RDOC-parsed parameter description here:
</span>      <span class='comment'>#options[:description] ||= Sprout::RDocParser.description_for_caller caller.shift
</span>
      <span class='id create_param_accessors'>create_param_accessors</span> <span class='id options'>options</span>
      <span class='id static_parameter_collection'>static_parameter_collection</span> <span class='op'>&lt;&lt;</span> <span class='id options'>options</span>
      <span class='id options'>options</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id add_param_alias'>add_param_alias</span> <span class='id new_name'>new_name</span><span class='comma'>,</span> <span class='id old_name'>old_name</span>
      <span class='id create_param_accessors'>create_param_accessors</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='id new_name'>new_name</span><span class='comma'>,</span> <span class='symbol'>:real_name</span> <span class='op'>=&gt;</span> <span class='id old_name'>old_name</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id static_parameter_collection'>static_parameter_collection</span>
      <span class='ivar'>@static_parameter_collection</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id static_default_value_collection'>static_default_value_collection</span>
      <span class='ivar'>@static_default_value_collection</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id set'>set</span> <span class='id key'>key</span><span class='comma'>,</span> <span class='id value'>value</span>
      <span class='id set_default_value'>set_default_value</span> <span class='id key'>key</span><span class='comma'>,</span> <span class='id value'>value</span>
    <span class='kw'>end</span>

    <span class='id private'>private</span>

    <span class='kw'>def</span> <span class='id accessor_can_be_defined_at'>accessor_can_be_defined_at</span> <span class='id name'>name</span>
      <span class='kw'>if</span><span class='lparen'>(</span><span class='id instance_defines?'>instance_defines?</span> <span class='id name'>name</span><span class='rparen'>)</span>
        <span class='id message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>add_param called with a name that is already in use (</span><span class='embexpr_beg'>#{</span><span class='id name'>name</span><span class='rbrace'>}</span><span class='tstring_content'>=) on (</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='rbrace'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span>
        <span class='id raise'>raise</span> <span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Errors</span><span class='op'>::</span><span class='const'>DuplicateMemberError</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='id message'>message</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id create_param_accessors'>create_param_accessors</span> <span class='id options'>options</span>
      <span class='id name'>name</span>      <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>
      <span class='id real_name'>real_name</span> <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:real_name</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id name'>name</span>
      <span class='id accessor_can_be_defined_at'>accessor_can_be_defined_at</span> <span class='id name'>name</span>

      <span class='comment'># define the writer:
</span>      <span class='id define_method'>define_method</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id name'>name</span><span class='rbrace'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id value'>value</span><span class='op'>|</span>
        <span class='kw'>if</span><span class='lparen'>(</span><span class='op'>!</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:writer</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id nil?'>nil?</span><span class='rparen'>)</span>
          <span class='id value'>value</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id send'>send</span><span class='lparen'>(</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:writer</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id value'>value</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='id param_hash'>param_hash</span><span class='lbracket'>[</span><span class='id real_name'>real_name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id value'>value</span> <span class='op'>=</span> <span class='id value'>value</span>
        <span class='id instance_variable_set'>instance_variable_set</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@</span><span class='embexpr_beg'>#{</span><span class='id name'>name</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id value'>value</span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='comment'># define the reader:
</span>      <span class='id define_method'>define_method</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span> <span class='kw'>do</span>     
        <span class='kw'>if</span><span class='lparen'>(</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:reader</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id nil?'>nil?</span><span class='rparen'>)</span>
          <span class='kw'>if</span><span class='lparen'>(</span><span class='id param_hash'>param_hash</span><span class='lbracket'>[</span><span class='id real_name'>real_name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id nil?'>nil?</span><span class='rparen'>)</span>
            <span class='id raise'>raise</span> <span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Errors</span><span class='op'>::</span><span class='const'>UsageError</span><span class='period'>.</span><span class='id new'>new</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unable to use requested parameter (</span><span class='embexpr_beg'>#{</span><span class='id real_name'>real_name</span><span class='rbrace'>}</span><span class='tstring_content'>) try adding it using:\n\n    add_param :</span><span class='embexpr_beg'>#{</span><span class='id real_name'>real_name</span><span class='rbrace'>}</span><span class='tstring_content'>, String\n\n</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>end</span>
          <span class='id param_hash'>param_hash</span><span class='lbracket'>[</span><span class='id real_name'>real_name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id value'>value</span>
        <span class='kw'>else</span>
          <span class='kw'>self</span><span class='period'>.</span><span class='id send'>send</span><span class='lparen'>(</span><span class='id options'>options</span><span class='lbracket'>[</span><span class='symbol'>:reader</span><span class='rbracket'>]</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id instance_defines?'>instance_defines?</span> <span class='id name'>name</span>
      <span class='comment'># In Ruby 1.9.1 instance_methods are symbols,
</span>      <span class='comment'># In Ruby 1.8.7 instance_methods are strings.
</span>      <span class='comment'># Boo.
</span>      <span class='kw'>self</span><span class='period'>.</span><span class='id instance_methods'>instance_methods</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span><span class='id name'>name</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='rparen'>)</span> <span class='op'>||</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id instance_methods'>instance_methods</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span><span class='id name'>name</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id set_default_value'>set_default_value</span> <span class='id key'>key</span><span class='comma'>,</span> <span class='id value'>value</span>
      <span class='kw'>if</span><span class='lparen'>(</span><span class='op'>!</span><span class='kw'>defined?</span> <span class='id key'>key</span><span class='rparen'>)</span>
        <span class='id raise'>raise</span> <span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Errors</span><span class='op'>::</span><span class='const'>UsageError</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Cannot set default value (</span><span class='embexpr_beg'>#{</span><span class='id value'>value</span><span class='rbrace'>}</span><span class='tstring_content'>) for unknown parameter (</span><span class='embexpr_beg'>#{</span><span class='id key'>key</span><span class='rbrace'>}</span><span class='tstring_content'>)</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='id static_default_value_collection'>static_default_value_collection</span> <span class='op'>&lt;&lt;</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='id key'>key</span><span class='comma'>,</span> <span class='symbol'>:value</span> <span class='op'>=&gt;</span> <span class='id value'>value</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='kw'>module</span> <span class='const'>InstanceMethods</span>
    <span class='comment'>##
</span>    <span class='comment'># The default RubyGem that we will use when requesting our executable.
</span>    <span class='comment'>#
</span>    <span class='comment'># Classes that include the Executable can set the default value for this property
</span>    <span class='comment'># at the class level with:
</span>    <span class='comment'>#
</span>    <span class='comment'>#     set :pkg_name, 'sprout-sometoolname'
</span>    <span class='comment'>#
</span>    <span class='comment'># But that value can be overridden on each instance like:
</span>    <span class='comment'>#
</span>    <span class='comment'>#     executable = SomeToolTask.new
</span>    <span class='comment'>#     executable.pkg_name = 'sprout-othertoolname'
</span>    <span class='comment'>#
</span>    <span class='comment'># This parameter is required - either from the including class or instance
</span>    <span class='comment'># configuration.
</span>    <span class='comment'>#
</span>    <span class='id attr_accessor'>attr_accessor</span> <span class='symbol'>:pkg_name</span>

    <span class='comment'>##
</span>    <span class='comment'># The default RubyGem version that we will use when requesting our executable.
</span>    <span class='comment'>#
</span>    <span class='comment'># Classes that include the Task can set the default value for this property
</span>    <span class='comment'># at the class level with:
</span>    <span class='comment'>#
</span>    <span class='comment'>#     set :pkg_version, '&gt;= 1.0.3'
</span>    <span class='comment'>#
</span>    <span class='comment'># But that value can be overriden on each instance like:
</span>    <span class='comment'>#
</span>    <span class='comment'>#     executable = SomeToolTask.new
</span>    <span class='comment'>#     too.pkg_version = '&gt;= 2.0.0'
</span>    <span class='comment'>#
</span>    <span class='comment'># This parameter is required - either from the including class or instance
</span>    <span class='comment'># configuration.
</span>    <span class='comment'>#
</span>    <span class='id attr_accessor'>attr_accessor</span> <span class='symbol'>:pkg_version</span>

    <span class='comment'>##
</span>    <span class='comment'># The default command line prefix that should be used in front of parameter
</span>    <span class='comment'># names.
</span>    <span class='comment'>#
</span>    <span class='comment'># The default value for this parameter is '--', but some command line
</span>    <span class='comment'># applications (like MXMLC) prefer '-'.
</span>    <span class='comment'>#
</span>    <span class='id attr_accessor'>attr_accessor</span> <span class='symbol'>:default_prefix</span>

    <span class='comment'>##
</span>    <span class='comment'># The default command line prefix for short name parameters.
</span>    <span class='comment'>#
</span>    <span class='comment'># This value defaults to '-', but can be changed to whatever a particular
</span>    <span class='comment'># tool prefers.
</span>    <span class='comment'>#
</span>    <span class='id attr_accessor'>attr_accessor</span> <span class='symbol'>:default_short_prefix</span>

    <span class='comment'>##
</span>    <span class='comment'># The default Sprout executable that we will use for this executable.
</span>    <span class='comment'>#
</span>    <span class='comment'># Classes that include the Task can set the default value for this property
</span>    <span class='comment'># at the class level with:
</span>    <span class='comment'>#
</span>    <span class='comment'>#     set :executable, :mxmlc
</span>    <span class='comment'>#
</span>    <span class='comment'># But that value can be overriden on each instance like:
</span>    <span class='comment'>#
</span>    <span class='comment'>#     executable = SomeToolTask.new
</span>    <span class='comment'>#     too.executable :compc
</span>    <span class='comment'>#
</span>    <span class='comment'># This parameter is required - either from the including class or instance
</span>    <span class='comment'># configuration.
</span>    <span class='comment'>#
</span>    <span class='id attr_accessor'>attr_accessor</span> <span class='symbol'>:executable</span>

    <span class='comment'>##
</span>    <span class='comment'># Configure the executable instance to output failure messages to
</span>    <span class='comment'># stderr and abort with non-zero response.
</span>    <span class='id attr_accessor'>attr_accessor</span> <span class='symbol'>:abort_on_failure</span>

    <span class='comment'>##
</span>    <span class='comment'># If the executable is configured as a Rake::Task, it will extract the
</span>    <span class='comment'># Rake::Task[:name] property and apply it to this field.
</span>    <span class='comment'>#
</span>    <span class='comment'># Concrete parameters can pull this value from their +belongs_to+ 
</span>    <span class='comment'># parameter.
</span>    <span class='id attr_accessor'>attr_accessor</span> <span class='symbol'>:rake_task_name</span>

    <span class='id attr_reader'>attr_reader</span> <span class='symbol'>:param_hash</span>
    <span class='id attr_reader'>attr_reader</span> <span class='symbol'>:params</span>
    <span class='id attr_reader'>attr_reader</span> <span class='symbol'>:prerequisites</span>

    <span class='kw'>def</span> <span class='id initialize'>initialize</span>
      <span class='kw'>super</span>
      <span class='ivar'>@abort_on_failure</span>     <span class='op'>=</span> <span class='kw'>true</span>
      <span class='ivar'>@appended_args</span>        <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='ivar'>@prepended_args</span>       <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='ivar'>@param_hash</span>           <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
      <span class='ivar'>@params</span>               <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='ivar'>@prerequisites</span>        <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='ivar'>@option_parser</span>        <span class='op'>=</span> <span class='const'>OptionParser</span><span class='period'>.</span><span class='id new'>new</span>
      <span class='ivar'>@default_prefix</span>       <span class='op'>=</span> <span class='const'>DEFAULT_PREFIX</span>
      <span class='ivar'>@default_short_prefix</span> <span class='op'>=</span> <span class='const'>DEFAULT_SHORT_PREFIX</span>
      <span class='id initialize_defaults'>initialize_defaults</span>
      <span class='id initialize_parameters'>initialize_parameters</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id parse!'>parse!</span> <span class='id commandline_options'>commandline_options</span>
      <span class='kw'>begin</span>
        <span class='id option_parser'>option_parser</span><span class='period'>.</span><span class='id parse!'>parse!</span> <span class='id commandline_options'>commandline_options</span>
        <span class='id parse_extra_options!'>parse_extra_options!</span> <span class='id commandline_options'>commandline_options</span>
        <span class='id validate'>validate</span> <span class='kw'>unless</span> <span class='id help_requested?'>help_requested?</span> <span class='id commandline_options'>commandline_options</span>
      <span class='kw'>rescue</span> <span class='const'>StandardError</span> <span class='op'>=&gt;</span> <span class='id e'>e</span>
        <span class='id handle_parse_error'>handle_parse_error</span> <span class='id e'>e</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='comment'>##
</span>    <span class='comment'># Execute the feature after calling parse
</span>    <span class='comment'># with command line arguments.
</span>    <span class='comment'>#
</span>    <span class='comment'># Subclasses will generally override this method
</span>    <span class='comment'># if they are a Ruby executable, but if you're 
</span>    <span class='comment'># just delegating to an external CLI application,
</span>    <span class='comment'># calling execute will wind up executing the 
</span>    <span class='comment'># external process.
</span>    <span class='kw'>def</span> <span class='id execute'>execute</span>
      <span class='id execute_delegate'>execute_delegate</span>
    <span class='kw'>end</span>

    <span class='comment'>##
</span>    <span class='comment'># Call the provided executable delegate.
</span>    <span class='comment'>#
</span>    <span class='comment'># This method is generally called from Rake task wrappers.
</span>    <span class='comment'>#
</span>    <span class='kw'>def</span> <span class='id execute_delegate'>execute_delegate</span>
      <span class='id system_execute'>system_execute</span> <span class='id binary_path'>binary_path</span><span class='comma'>,</span> <span class='id to_shell'>to_shell</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id prepare'>prepare</span>
      <span class='id params'>params</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id param'>param</span><span class='op'>|</span>
        <span class='id param'>param</span><span class='period'>.</span><span class='id prepare'>prepare</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id to_rake'>to_rake</span> <span class='op'>*</span><span class='id args'>args</span>
      <span class='comment'># Define the file task first - so that
</span>      <span class='comment'># desc blocks hook up to it...
</span>      <span class='id outer_task'>outer_task</span> <span class='op'>=</span> <span class='id create_outer_task'>create_outer_task</span> <span class='op'>*</span><span class='id args'>args</span>
      <span class='id update_rake_task_name_from_args'>update_rake_task_name_from_args</span> <span class='op'>*</span><span class='id args'>args</span>
      <span class='kw'>yield</span> <span class='kw'>self</span> <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
      <span class='id prepare'>prepare</span>

      <span class='comment'># TODO: Tried auto-updating with library
</span>      <span class='comment'># prerequisites, but this led to strange
</span>      <span class='comment'># behavior with multiple registrations.
</span>      <span class='id handle_library_prerequisites'>handle_library_prerequisites</span> <span class='id outer_task'>outer_task</span><span class='period'>.</span><span class='id prerequisites'>prerequisites</span>

      <span class='comment'># Add the library resolution rake task
</span>      <span class='comment'># as a prerequisite
</span>      <span class='id outer_task'>outer_task</span><span class='period'>.</span><span class='id prerequisites'>prerequisites</span> <span class='op'>&lt;&lt;</span> <span class='id task'>task</span><span class='lparen'>(</span><span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Library</span><span class='op'>::</span><span class='const'>TASK_NAME</span><span class='rparen'>)</span>
      <span class='id prerequisites'>prerequisites</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id prereq'>prereq</span><span class='op'>|</span>
        <span class='id outer_task'>outer_task</span><span class='period'>.</span><span class='id prerequisites'>prerequisites</span> <span class='op'>&lt;&lt;</span> <span class='id prereq'>prereq</span>
      <span class='kw'>end</span>
      <span class='id outer_task'>outer_task</span>
    <span class='kw'>end</span>

    <span class='comment'>##
</span>    <span class='comment'># This will create a hash of ONLY values that are created
</span>    <span class='comment'># using +add_param+, properties that are created with
</span>    <span class='comment'># attr_accessor must be handled manually, or patches are welcome!
</span>    <span class='kw'>def</span> <span class='id to_hash'>to_hash</span>
      <span class='id result'>result</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
      <span class='id params'>params</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id param'>param</span><span class='op'>|</span>
        <span class='id result'>result</span><span class='lbracket'>[</span><span class='id param'>param</span><span class='period'>.</span><span class='id name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id send'>send</span><span class='lparen'>(</span><span class='id param'>param</span><span class='period'>.</span><span class='id name'>name</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='id result'>result</span>
    <span class='kw'>end</span>

    <span class='comment'>##
</span>    <span class='comment'># This will ignore unknown parameters, because our very
</span>    <span class='comment'># first use case, is when generators call other generators
</span>    <span class='comment'># and generator A might have different parameters than
</span>    <span class='comment'># generator B.
</span>    <span class='kw'>def</span> <span class='id from_hash'>from_hash</span> <span class='id hash'>hash</span>
      <span class='id hash'>hash</span><span class='period'>.</span><span class='id each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id key'>key</span><span class='comma'>,</span> <span class='id value'>value</span><span class='op'>|</span>
        <span class='kw'>if</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='id key'>key</span><span class='rparen'>)</span><span class='rparen'>)</span>
          <span class='kw'>self</span><span class='period'>.</span><span class='id send'>send</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id key'>key</span><span class='rbrace'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id value'>value</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id to_help'>to_help</span>
      <span class='id option_parser'>option_parser</span><span class='period'>.</span><span class='id to_s'>to_s</span>
    <span class='kw'>end</span>

    <span class='comment'># Create a string that represents this configured executable for shell execution
</span>    <span class='kw'>def</span> <span class='id to_shell'>to_shell</span>
      <span class='kw'>return</span> <span class='ivar'>@to_shell_proc</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span><span class='kw'>self</span><span class='rparen'>)</span> <span class='kw'>unless</span> <span class='ivar'>@to_shell_proc</span><span class='period'>.</span><span class='id nil?'>nil?</span>

      <span class='id result'>result</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='id result'>result</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@prepended_args</span> <span class='kw'>unless</span> <span class='ivar'>@prepended_args</span><span class='period'>.</span><span class='id nil?'>nil?</span>
      <span class='id params'>params</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id param'>param</span><span class='op'>|</span>
        <span class='kw'>if</span><span class='lparen'>(</span><span class='id param'>param</span><span class='period'>.</span><span class='id visible?'>visible?</span><span class='rparen'>)</span>
          <span class='id result'>result</span> <span class='op'>&lt;&lt;</span> <span class='id param'>param</span><span class='period'>.</span><span class='id to_shell'>to_shell</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='id result'>result</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@appended_args</span> <span class='kw'>unless</span> <span class='ivar'>@appended_args</span><span class='period'>.</span><span class='id nil?'>nil?</span>
      <span class='kw'>return</span> <span class='id result'>result</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> </span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='comment'>##
</span>    <span class='comment'># Called by Parameters like :path and :paths
</span>    <span class='comment'>#
</span>    <span class='kw'>def</span> <span class='id default_file_expression'>default_file_expression</span>
      <span class='ivar'>@default_file_expression</span> <span class='op'>||=</span> <span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Executable</span><span class='op'>::</span><span class='const'>DEFAULT_FILE_EXPRESSION</span>
    <span class='kw'>end</span>

    <span class='id protected'>protected</span>

    <span class='comment'>##
</span>    <span class='comment'># Create the outer rake task. 
</span>    <span class='comment'># For most executables, this will be a Rake::File task,
</span>    <span class='comment'># This is a template method that should be overridden
</span>    <span class='comment'># for executables that do not result in the creation of
</span>    <span class='comment'># a file.
</span>    <span class='comment'>#
</span>    <span class='comment'># @see update_rake_task_name_from_args
</span>    <span class='kw'>def</span> <span class='id create_outer_task'>create_outer_task</span> <span class='op'>*</span><span class='id args'>args</span>
      <span class='id file'>file</span> <span class='op'>*</span><span class='id args'>args</span> <span class='kw'>do</span>
        <span class='id execute'>execute</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='comment'>##
</span>    <span class='comment'># This method will add the current task to the Rake CLEAN
</span>    <span class='comment'># collection.
</span>    <span class='comment'># 
</span>    <span class='comment'># Any Executable that does not create a Rake::File task
</span>    <span class='comment'># should also override this method and prevent it from
</span>    <span class='comment'># calling +CLEAN.add+.
</span>    <span class='comment'>#
</span>    <span class='comment'># @see create_outer_task
</span>    <span class='kw'>def</span> <span class='id update_rake_task_name_from_args'>update_rake_task_name_from_args</span> <span class='op'>*</span><span class='id args'>args</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id rake_task_name'>rake_task_name</span> <span class='op'>=</span> <span class='id parse_rake_task_arg'>parse_rake_task_arg</span> <span class='id args'>args</span><span class='period'>.</span><span class='id last'>last</span>
      <span class='const'>CLEAN</span><span class='period'>.</span><span class='id add'>add</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id rake_task_name'>rake_task_name</span><span class='rparen'>)</span>
      <span class='kw'>self</span><span class='period'>.</span><span class='id rake_task_name'>rake_task_name</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id parse_rake_task_arg'>parse_rake_task_arg</span> <span class='id arg'>arg</span>
      <span class='kw'>return</span> <span class='id arg'>arg</span> <span class='kw'>if</span> <span class='id arg'>arg</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Symbol</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id arg'>arg</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>String</span><span class='rparen'>)</span>
      <span class='id arg'>arg</span><span class='period'>.</span><span class='id each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id key'>key</span><span class='comma'>,</span> <span class='id value'>value</span><span class='op'>|</span>
        <span class='kw'>return</span> <span class='id key'>key</span>
      <span class='kw'>end</span>
      <span class='kw'>nil</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id parse_extra_options!'>parse_extra_options!</span> <span class='id options'>options</span>
      <span class='id options'>options</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id value'>value</span><span class='op'>|</span>
        <span class='id params'>params</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id param'>param</span><span class='op'>|</span>
          <span class='kw'>if</span> <span class='id param'>param</span><span class='period'>.</span><span class='id hidden_name?'>hidden_name?</span>
            <span class='kw'>self</span><span class='period'>.</span><span class='id send'>send</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id param'>param</span><span class='period'>.</span><span class='id name'>name</span><span class='rbrace'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id value'>value</span>
            <span class='kw'>break</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='comment'>##
</span>    <span class='comment'># This method will generally be overridden
</span>    <span class='comment'># by subclasses and they can do whatever customization
</span>    <span class='comment'># is necessary for a particular library type.
</span>    <span class='comment'>#
</span>    <span class='comment'># It's important to note that this value can be
</span>    <span class='comment'># a String path to a file (or folder), or it can
</span>    <span class='comment'># be an Array of paths to files (or folders).
</span>    <span class='kw'>def</span> <span class='id library_added'>library_added</span> <span class='id path_or_paths'>path_or_paths</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id system_execute'>system_execute</span> <span class='id binary'>binary</span><span class='comma'>,</span> <span class='id params'>params</span>
      <span class='const'>Sprout</span><span class='period'>.</span><span class='id current_system'>current_system</span><span class='period'>.</span><span class='id execute'>execute</span> <span class='id binary'>binary</span><span class='comma'>,</span> <span class='id params'>params</span>
    <span class='kw'>end</span>

    <span class='id private'>private</span>

    <span class='kw'>def</span> <span class='id binary_path'>binary_path</span>
      <span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Executable</span><span class='period'>.</span><span class='id load'>load</span><span class='lparen'>(</span><span class='id executable'>executable</span><span class='comma'>,</span> <span class='id pkg_name'>pkg_name</span><span class='comma'>,</span> <span class='id pkg_version'>pkg_version</span><span class='rparen'>)</span><span class='period'>.</span><span class='id path'>path</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id handle_library_prerequisites'>handle_library_prerequisites</span> <span class='id items'>items</span>
      <span class='id items'>items</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id task_name'>task_name</span><span class='op'>|</span>
        <span class='id t'>t</span> <span class='op'>=</span> <span class='const'>Rake</span><span class='period'>.</span><span class='id application'>application</span><span class='lbracket'>[</span><span class='id task_name'>task_name</span><span class='rbracket'>]</span>
        <span class='kw'>if</span><span class='lparen'>(</span><span class='op'>!</span><span class='id t'>t</span><span class='period'>.</span><span class='id sprout_entity'>sprout_entity</span><span class='period'>.</span><span class='id nil?'>nil?</span><span class='rparen'>)</span>
          <span class='id library_added'>library_added</span> <span class='id t'>t</span><span class='period'>.</span><span class='id sprout_entity'>sprout_entity</span><span class='period'>.</span><span class='id installed_project_path'>installed_project_path</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id help_requested?'>help_requested?</span> <span class='id options'>options</span>
      <span class='id options'>options</span><span class='period'>.</span><span class='id include?'>include?</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>--help</span><span class='tstring_end'>'</span></span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id handle_parse_error'>handle_parse_error</span> <span class='id error'>error</span>
      <span class='kw'>if</span><span class='lparen'>(</span><span class='id abort_on_failure'>abort_on_failure</span><span class='rparen'>)</span>
        <span class='id parts'>parts</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
        <span class='id parts'>parts</span> <span class='op'>&lt;&lt;</span> <span class='kw'>nil</span>
        <span class='id parts'>parts</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>[ERROR - </span><span class='embexpr_beg'>#{</span><span class='id error'>error</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id name'>name</span><span class='rbrace'>}</span><span class='tstring_content'>] </span><span class='embexpr_beg'>#{</span><span class='id error'>error</span><span class='period'>.</span><span class='id message'>message</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='id parts'>parts</span> <span class='op'>&lt;&lt;</span> <span class='kw'>nil</span>
        <span class='id parts'>parts</span> <span class='op'>&lt;&lt;</span> <span class='id option_parser'>option_parser</span><span class='period'>.</span><span class='id to_s'>to_s</span>
        <span class='id parts'>parts</span> <span class='op'>&lt;&lt;</span> <span class='kw'>nil</span>
        <span class='id abort'>abort</span> <span class='id parts'>parts</span><span class='period'>.</span><span class='id join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>else</span>
        <span class='id raise'>raise</span> <span class='id error'>error</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id initialize_parameters'>initialize_parameters</span>
      <span class='id add_help_param'>add_help_param</span>
      <span class='id assembled_parameter_collection'>assembled_parameter_collection</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id declaration'>declaration</span><span class='op'>|</span>
        <span class='id param'>param</span> <span class='op'>=</span> <span class='id initialize_parameter'>initialize_parameter</span> <span class='id declaration'>declaration</span>
        <span class='id short'>short</span> <span class='op'>=</span> <span class='id param'>param</span><span class='period'>.</span><span class='id option_parser_short_name'>option_parser_short_name</span>

        <span class='id option_parser'>option_parser</span><span class='period'>.</span><span class='id on'>on</span> <span class='id short'>short</span><span class='comma'>,</span> 
                         <span class='id param'>param</span><span class='period'>.</span><span class='id option_parser_declaration'>option_parser_declaration</span><span class='comma'>,</span> 
                         <span class='id param'>param</span><span class='period'>.</span><span class='id description'>description</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id value'>value</span><span class='op'>|</span>
          <span class='kw'>if</span><span class='lparen'>(</span><span class='id param'>param</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>CollectionParam</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id param'>param</span><span class='period'>.</span><span class='id delimiter'>delimiter</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>+=</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
            <span class='id eval'>eval</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>self.</span><span class='embexpr_beg'>#{</span><span class='id param'>param</span><span class='period'>.</span><span class='id name'>name</span><span class='rbrace'>}</span><span class='tstring_content'> &lt;&lt; '</span><span class='embexpr_beg'>#{</span><span class='id value'>value</span><span class='rbrace'>}</span><span class='tstring_content'>'</span><span class='tstring_end'>&quot;</span></span>
          <span class='kw'>else</span>
            <span class='kw'>self</span><span class='period'>.</span><span class='id send'>send</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id param'>param</span><span class='period'>.</span><span class='id name'>name</span><span class='rbrace'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id value'>value</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id initialize_defaults'>initialize_defaults</span>
      <span class='id assembled_default_parameter_collection'>assembled_default_parameter_collection</span><span class='period'>.</span><span class='id reverse'>reverse</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id option'>option</span><span class='op'>|</span>
        <span class='comment'>#puts &quot;&gt;&gt; updating default on: #{self} for: #{option[:name]} with: #{option[:value]}&quot;
</span>        <span class='kw'>self</span><span class='period'>.</span><span class='id send'>send</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id option'>option</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id option'>option</span><span class='lbracket'>[</span><span class='symbol'>:value</span><span class='rbracket'>]</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id assembled_parameter_collection'>assembled_parameter_collection</span>
      <span class='id assembled_static_collection'>assembled_static_collection</span> <span class='symbol'>:static_parameter_collection</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id assembled_default_parameter_collection'>assembled_default_parameter_collection</span>
      <span class='id assembled_static_collection'>assembled_static_collection</span> <span class='symbol'>:static_default_value_collection</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id assembled_static_collection'>assembled_static_collection</span> <span class='id collection_name'>collection_name</span>
      <span class='id collection'>collection</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='id inheritance_chain'>inheritance_chain</span><span class='period'>.</span><span class='id reverse'>reverse</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id clazz'>clazz</span><span class='op'>|</span>
        <span class='kw'>if</span><span class='lparen'>(</span><span class='id clazz'>clazz</span><span class='period'>.</span><span class='id respond_to?'>respond_to?</span><span class='lparen'>(</span><span class='id collection_name'>collection_name</span><span class='rparen'>)</span><span class='rparen'>)</span>
          <span class='id collection'>collection</span><span class='period'>.</span><span class='id concat'>concat</span> <span class='id clazz'>clazz</span><span class='period'>.</span><span class='id send'>send</span><span class='lparen'>(</span><span class='id collection_name'>collection_name</span><span class='rparen'>)</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='id collection'>collection</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id inheritance_chain'>inheritance_chain</span>
      <span class='id chain'>chain</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
      <span class='id clazz'>clazz</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span>
      <span class='kw'>while</span> <span class='id clazz'>clazz</span> <span class='kw'>do</span>
        <span class='id chain'>chain</span> <span class='op'>&lt;&lt;</span> <span class='id clazz'>clazz</span>
        <span class='id clazz'>clazz</span> <span class='op'>=</span> <span class='id clazz'>clazz</span><span class='period'>.</span><span class='id superclass'>superclass</span>
      <span class='kw'>end</span>
      <span class='id chain'>chain</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id add_help_param'>add_help_param</span>
      <span class='id option_parser'>option_parser</span><span class='period'>.</span><span class='id on'>on</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>--help</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Display this help message</span><span class='tstring_end'>'</span></span> <span class='kw'>do</span>
        <span class='id puts'>puts</span> <span class='id option_parser'>option_parser</span><span class='period'>.</span><span class='id to_s'>to_s</span>
        <span class='id exit'>exit</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id initialize_parameter'>initialize_parameter</span> <span class='id declaration'>declaration</span>
      <span class='id name'>name</span>   <span class='op'>=</span> <span class='id declaration'>declaration</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>
      <span class='id name_s'>name_s</span> <span class='op'>=</span> <span class='id name'>name</span><span class='period'>.</span><span class='id to_s'>to_s</span>
      <span class='id type'>type</span>   <span class='op'>=</span> <span class='id declaration'>declaration</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span>

      <span class='comment'># First ensure the named accessor doesn't yet exist...
</span>      <span class='kw'>if</span><span class='lparen'>(</span><span class='id parameter_hash_includes?'>parameter_hash_includes?</span> <span class='id name'>name</span><span class='rparen'>)</span>
        <span class='id raise'>raise</span> <span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Errors</span><span class='op'>::</span><span class='const'>ExecutableError</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>ToolTask.add_param called with existing parameter name: </span><span class='embexpr_beg'>#{</span><span class='id name_s'>name_s</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>

      <span class='id create_parameter'>create_parameter</span> <span class='id declaration'>declaration</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id create_parameter'>create_parameter</span> <span class='id declaration'>declaration</span>
      <span class='id param'>param</span> <span class='op'>=</span> <span class='const'>ParameterFactory</span><span class='period'>.</span><span class='id create'>create</span> <span class='id declaration'>declaration</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span>
      <span class='id param'>param</span><span class='period'>.</span><span class='id belongs_to'>belongs_to</span> <span class='op'>=</span> <span class='kw'>self</span>

      <span class='kw'>begin</span>
        <span class='id declaration'>declaration</span><span class='period'>.</span><span class='id each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id key'>key</span><span class='comma'>,</span> <span class='id value'>value</span><span class='op'>|</span>
          <span class='id param'>param</span><span class='period'>.</span><span class='id send'>send</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id key'>key</span><span class='rbrace'>}</span><span class='tstring_content'>=</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id value'>value</span>
        <span class='kw'>end</span>
      <span class='kw'>rescue</span> <span class='const'>ArgumentError</span>
        <span class='id raise'>raise</span> <span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Errors</span><span class='op'>::</span><span class='const'>UsageError</span><span class='period'>.</span><span class='id new'>new</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unexpected parameter option encountered with: </span><span class='embexpr_beg'>#{</span><span class='id key'>key</span><span class='rbrace'>}</span><span class='tstring_content'> and value: </span><span class='embexpr_beg'>#{</span><span class='id value'>value</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>end</span>

      <span class='id raise'>raise</span> <span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Errors</span><span class='op'>::</span><span class='const'>UsageError</span><span class='period'>.</span><span class='id new'>new</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Parameter name is required</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span><span class='lparen'>(</span><span class='id param'>param</span><span class='period'>.</span><span class='id name'>name</span><span class='period'>.</span><span class='id nil?'>nil?</span><span class='rparen'>)</span>

      <span class='id param_hash'>param_hash</span><span class='lbracket'>[</span><span class='id param'>param</span><span class='period'>.</span><span class='id name'>name</span><span class='period'>.</span><span class='id to_sym'>to_sym</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id param'>param</span>
      <span class='id params'>params</span> <span class='op'>&lt;&lt;</span> <span class='id param'>param</span>

      <span class='comment'># Expose this parameter to command line arguments:
</span>      <span class='comment'>#add_commandline_param param
</span>
      <span class='id param'>param</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id parameter_hash_includes?'>parameter_hash_includes?</span> <span class='id name'>name</span>
      <span class='id param_hash'>param_hash</span><span class='period'>.</span><span class='id has_key?'>has_key?</span> <span class='id name'>name</span><span class='period'>.</span><span class='id to_sym'>to_sym</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id validate'>validate</span>
      <span class='id params'>params</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id param'>param</span><span class='op'>|</span>
        <span class='id param'>param</span><span class='period'>.</span><span class='id validate'>validate</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='kw'>def</span> <span class='id option_parser'>option_parser</span>
      <span class='ivar'>@option_parser</span>
    <span class='kw'>end</span>

  <span class='kw'>end</span>
<span class='kw'>end</span></pre>

<p>end</p>
</div></div>
    
    <div id="footer">
  Generated on Tue Dec 21 11:09:49 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.3 (ruby-1.9.2).
</div>

  </body>
</html>