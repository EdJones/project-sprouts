<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>File: specification</title>
<link rel="stylesheet" href="css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="_index.html" title="Index">Index</a> &raquo; 
    <span class="title">File: specification</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><div id='filecontents'>
<p>module Sprout</p>

<pre class="code"><span class='comment'>##
</span><span class='comment'># Sprouts provides us with the ability to distribute source files, 
</span><span class='comment'># precompiled libraries, and remote executables. It does all of 
</span><span class='comment'># this by (ab)using RubyGems.
</span><span class='comment'>#
</span><span class='comment'># RubyGems gives us the ability to version-manage, and distribute 
</span><span class='comment'># arbitrary text and binary payloads.
</span><span class='comment'>#
</span><span class='comment'># In order to support Flash development, we have one major problem
</span><span class='comment'># that RubyGems does not solve for us. This is the fact that 
</span><span class='comment'># many elements of our executable chain are not open-source, and we do
</span><span class='comment'># not have the rights to directly distribute them.
</span><span class='comment'>#
</span><span class='comment'># This restriction means that many of our tools and dependencies cannot be 
</span><span class='comment'># packaged and distributed _directly_ within a RubyGem (or from
</span><span class='comment'># any server other than Adobe's as a matter of fact).
</span><span class='comment'>#
</span><span class='comment'># In order to overcome this restriction, we have introduced
</span><span class='comment'># a Sprout::Specification. This is a regular Ruby file with regular
</span><span class='comment'># Ruby code in it. The main idea behind this file, is that it
</span><span class='comment'># needs to be given a name and available in your load path.
</span><span class='comment'>#
</span><span class='comment'># Whenever a rake build task (Sprout::Executable) or library task,
</span><span class='comment'># (Sprout::Library) is encountered, it will call
</span><span class='comment'># Sprout::Executable.load or Sprout::Library.load (respectively).
</span><span class='comment'>#
</span><span class='comment'># These methods will attempt to +require+ the provided
</span><span class='comment'># specification and - if it's in your load path - the specification
</span><span class='comment'># will be loaded, and any relevant file targets will be returned.
</span><span class='comment'>#
</span><span class='comment'># There are many ways to get Ruby code into your load path.
</span><span class='comment'># One of the easiest to package it up in a RubyGem and
</span><span class='comment'># configure the +require_paths+ parameter of  your Gem::Specification.
</span><span class='comment'>#
</span><span class='comment'># http://docs.rubygems.org/read/chapter/20#require_paths
</span><span class='comment'>#
</span><span class='comment'># To learn more about packaging RubyGems:
</span><span class='comment'>#
</span><span class='comment'># http://docs.rubygems.org/read/chapter/20#page85
</span><span class='comment'># http://rubygems.rubyforge.org/rdoc/Gem/Specification.html
</span><span class='comment'>#
</span><span class='comment'># To learn more about published RubyGems:
</span><span class='comment'># 
</span><span class='comment'># http://rubygems.org/pages/gem_docs
</span><span class='comment'>#
</span><span class='comment'># To package a SWC library into a Sprout RubyGem, you would create a file (usually)
</span><span class='comment'># named [project_name.spec] in the root of the project.
</span><span class='comment'>#
</span><span class='comment'># This is your Gem::Specification.
</span><span class='comment'>#
</span><span class='comment'># You would also create a file named [projet_name.rb] and put that
</span><span class='comment'># into the root of the project or some other folder that you have added to 
</span><span class='comment'># the Gem::Specification.require_paths parameter.
</span><span class='comment'>#
</span><span class='comment'># == Example: Include a file directly in the RubyGem
</span><span class='comment'>#
</span><span class='comment'># In the case of AsUnit, this file would be named asunit4.rb and it's contents
</span><span class='comment'># are as follows:
</span><span class='comment'>#
</span><span class='comment'>#    :include:../../test/fixtures/specification/asunit4.rb
</span><span class='comment'>#
</span><span class='comment'># == Example: Refer to files that are not in the RubyGem
</span><span class='comment'>#
</span><span class='comment'># For projects like the Flex SDK, we can't distribute many of the required files,
</span><span class='comment'># so we can refer to these files in our Sprout::Specification as +remote_file_targets+.
</span><span class='comment'>#
</span><span class='comment'>#    :include:../../test/fixtures/specification/flex4sdk.rb
</span><span class='comment'>#
</span><span class='comment'># == Example: Create custom downloads for each supported platform
</span><span class='comment'>#
</span><span class='comment'># For projects like the Flash Player itself, we need to refer to different 
</span><span class='comment'># downloadable content for each supported platform.
</span><span class='comment'>#
</span><span class='comment'>#    :include:../../test/fixtures/specification/flashplayer.rb
</span><span class='comment'>#
</span><span class='comment'># == Packaging and Sharing
</span><span class='comment'>#
</span><span class='comment'># Public RubyGems are hosted at http://rubygems.org. 
</span><span class='kw'>class</span> <span class='const'>Specification</span>

  <span class='id attr_accessor'>attr_accessor</span> <span class='symbol'>:name</span>
  <span class='id attr_accessor'>attr_accessor</span> <span class='symbol'>:version</span>

  <span class='id attr_reader'>attr_reader</span> <span class='symbol'>:file_targets</span>
  <span class='id attr_reader'>attr_reader</span> <span class='symbol'>:load_path</span>

  <span class='comment'>##
</span>  <span class='comment'># Create a new Sprout::Specification.
</span>  <span class='comment'>#
</span>  <span class='comment'># This method will yield the new Sprout::Specification to the provided block,
</span>  <span class='comment'># and delegate most configuration parameters to a {Gem::Specification}[http://rubygems.rubyforge.org/rdoc/Gem/Specification.html].
</span>  <span class='comment'>#
</span>  <span class='comment'># To learn more about what parameters are available and/or required, please
</span>  <span class='comment'># check out RubyGems documentation for their {Gem::Specification}[http://rubygems.rubyforge.org/rdoc/Gem/Specification.html].
</span>  <span class='comment'>#
</span>  <span class='kw'>def</span> <span class='id initialize'>initialize</span>
    <span class='id filename'>filename</span>   <span class='op'>=</span> <span class='const'>Sprout</span><span class='period'>.</span><span class='id file_from_caller'>file_from_caller</span> <span class='id caller'>caller</span><span class='period'>.</span><span class='id first'>first</span>
    <span class='ivar'>@load_path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id dirname'>dirname</span> <span class='id filename'>filename</span>
    <span class='ivar'>@name</span>      <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id basename'>basename</span><span class='lparen'>(</span><span class='id filename'>filename</span><span class='rparen'>)</span><span class='period'>.</span><span class='id gsub'>gsub</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>.rb</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='rparen'>)</span>
    <span class='kw'>yield</span> <span class='kw'>self</span> <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
  <span class='kw'>end</span>

  <span class='comment'>##
</span>  <span class='comment'># Add a remote file target to this RubyGem so that when it
</span>  <span class='comment'># is loaded, Sprouts will go fetch this file from the network.
</span>  <span class='comment'>#
</span>  <span class='comment'># Each time this method is called, a new Sprout::RemoteFiletarget instance will be yielded to
</span>  <span class='comment'># the provided block and resolved after the block completes.
</span>  <span class='comment'>#
</span>  <span class='comment'># After this block is evaluated, Sprouts will first check the collection
</span>  <span class='comment'># of env_names to see if the expected paths are available. If a valid
</span>  <span class='comment'># env_name is found, Sprouts will return the path to the requested
</span>  <span class='comment'># executable from the environment variable.
</span>  <span class='comment'>#
</span>  <span class='comment'># If no env_names are set, or the requested executable is not found within
</span>  <span class='comment'># any that are identified, Sprouts will check to see if the archive
</span>  <span class='comment'># has already been unpacked into the expected location:
</span>  <span class='comment'># 
</span>  <span class='comment'>#     #{SPROUT_HOME}/cache/#{SPROUT_VERSION}/flex4sdk/#{md5}/4.0.pre
</span>  <span class='comment'>#
</span>  <span class='comment'># If the archive been unpacked, Sprouts will return the path to the 
</span>  <span class='comment'># requested executable.
</span>  <span class='comment'>#
</span>  <span class='comment'># If the archive has not been unpacked, Sprouts will check to see if the
</span>  <span class='comment'># archive has been downloaded to:
</span>  <span class='comment'>#
</span>  <span class='comment'>#     #{SPROUT_HOME}/cache/#{SPROUT_VERSION}/flex4sdk/#{md5}.zip
</span>  <span class='comment'>#
</span>  <span class='comment'># If the archive has been downloaded, it will be unpacked and the path
</span>  <span class='comment'># to the requested executable will be returned.
</span>  <span class='comment'>#
</span>  <span class='comment'># If the archive has not been downloaded, it will be downloaded, unpacked
</span>  <span class='comment'># and the path to the requested executable will be returned.
</span>  <span class='kw'>def</span> <span class='id add_remote_file_target'>add_remote_file_target</span> <span class='op'>&amp;</span><span class='id block'>block</span>
    <span class='id target'>target</span> <span class='op'>=</span> <span class='const'>RemoteFileTarget</span><span class='period'>.</span><span class='id new'>new</span>
    <span class='id configure_target'>configure_target</span> <span class='id target'>target</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span>
  <span class='kw'>end</span>

  <span class='comment'># Add a file to the RubyGem itself. This is a great way to package smallish libraries in either
</span>  <span class='comment'># source or already-packaged form. For example, one might add a SWC to a RubyGem library.
</span>  <span class='comment'># 
</span>  <span class='comment'># Each time this method is called, a new Sprout::FileTarget instance will be yielded to the
</span>  <span class='comment'># provided block, and added to a collection for packaging.
</span>  <span class='comment'>#
</span>  <span class='comment'>#     Sprout::Specification.new do |s|
</span>  <span class='comment'>#        ...
</span>  <span class='comment'>#        s.add_file_target do |t|
</span>  <span class='comment'>#           t.platform = :universal
</span>  <span class='comment'>#           t.add_executable :asdoc, 'bin/asdoc'
</span>  <span class='comment'>#        end
</span>  <span class='comment'>#     end
</span>  <span class='comment'>#
</span>  <span class='kw'>def</span> <span class='id add_file_target'>add_file_target</span> <span class='op'>&amp;</span><span class='id block'>block</span>
    <span class='id target'>target</span> <span class='op'>=</span> <span class='const'>FileTarget</span><span class='period'>.</span><span class='id new'>new</span>
    <span class='id configure_target'>configure_target</span> <span class='id target'>target</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span>
  <span class='kw'>end</span>

  <span class='id private'>private</span>

  <span class='kw'>def</span> <span class='id configure_target'>configure_target</span> <span class='id t'>t</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span>
    <span class='id t'>t</span><span class='period'>.</span><span class='id load_path'>load_path</span>   <span class='op'>=</span> <span class='id load_path'>load_path</span>
    <span class='id t'>t</span><span class='period'>.</span><span class='id pkg_name'>pkg_name</span>    <span class='op'>=</span> <span class='id name'>name</span>
    <span class='id t'>t</span><span class='period'>.</span><span class='id pkg_version'>pkg_version</span> <span class='op'>=</span> <span class='id version'>version</span>
    <span class='kw'>yield</span> <span class='id t'>t</span> <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
    <span class='id register_file_target_libs_and_exes'>register_file_target_libs_and_exes</span> <span class='id t'>t</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id register_file_target_libs_and_exes'>register_file_target_libs_and_exes</span> <span class='id target'>target</span>
    <span class='id register_items'>register_items</span> <span class='id target'>target</span><span class='period'>.</span><span class='id executables'>executables</span><span class='comma'>,</span> <span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Executable</span><span class='comma'>,</span> <span class='id target'>target</span>
    <span class='comment'># Reversing the libraries makes it so that definitions like:
</span>    <span class='comment'>#
</span>    <span class='comment'>#   target.add_library :swc, 'abcd'
</span>    <span class='comment'>#   target.add_library :src, 'efgh'
</span>    <span class='comment'># 
</span>    <span class='comment'># When loading, if no name is specified, the :swc will be
</span>    <span class='comment'># returned to clients.
</span>    <span class='id register_items'>register_items</span> <span class='id target'>target</span><span class='period'>.</span><span class='id libraries'>libraries</span><span class='comma'>,</span> <span class='const'>Sprout</span><span class='op'>::</span><span class='const'>Library</span><span class='comma'>,</span> <span class='id target'>target</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id register_items'>register_items</span> <span class='id collection'>collection</span><span class='comma'>,</span> <span class='id ruby_feature'>ruby_feature</span><span class='comma'>,</span> <span class='id target'>target</span>
    <span class='id collection'>collection</span><span class='period'>.</span><span class='id each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id exe_or_lib'>exe_or_lib</span><span class='op'>|</span>
      <span class='id exe_or_lib'>exe_or_lib</span><span class='period'>.</span><span class='id pkg_name'>pkg_name</span>    <span class='op'>=</span> <span class='id target'>target</span><span class='period'>.</span><span class='id pkg_name'>pkg_name</span>
      <span class='id exe_or_lib'>exe_or_lib</span><span class='period'>.</span><span class='id pkg_version'>pkg_version</span> <span class='op'>=</span> <span class='id target'>target</span><span class='period'>.</span><span class='id pkg_version'>pkg_version</span>
      <span class='id exe_or_lib'>exe_or_lib</span><span class='period'>.</span><span class='id platform'>platform</span>    <span class='op'>=</span> <span class='id target'>target</span><span class='period'>.</span><span class='id platform'>platform</span>
      <span class='id exe_or_lib'>exe_or_lib</span><span class='period'>.</span><span class='id file_target'>file_target</span> <span class='op'>=</span> <span class='id target'>target</span>
      <span class='id ruby_feature'>ruby_feature</span><span class='period'>.</span><span class='id register'>register</span> <span class='id exe_or_lib'>exe_or_lib</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

<span class='kw'>end</span></pre>

<p>end</p>
</div></div>
    
    <div id="footer">
  Generated on Tue Dec 21 11:09:49 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.3 (ruby-1.9.2).
</div>

  </body>
</html>